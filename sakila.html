<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Questions and Answers</title>
    <style>
        /* Dark mode styling */
        .explanation {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 5px;
            color: #e0e0e0;
            margin-bottom: 40px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .explanation h3,
        .explanation h3 {
            color: #bb86fc;
        }

        .explanation ul {
            list-style-type: disc;
            margin-left: 20px;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #ffffff;
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #f18a14;
        }

        h2 {
            text-align: center;
            color: #7b4eeb;
        }

        .business{
            text-align: left;
            color: #bb86fc;
        }
        h3 {
            color: #1e77c1;
        }

        pre {
            background-color: #1e1e1e;
            padding: 15px;
            border-radius: 5px;
            position: relative;
            /* Relative for positioning button inside */
            overflow-x: auto;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .question {
            margin-bottom: 30px;
        }

        code {
            font-family: "Courier New", Courier, monospace;
            color: #ffffff;
        }

        /* Styling for the copy button */
        button {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background-color: #14c6b4;
            color: #121212;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        button:hover {
            background-color: #00bfa5;
        }

        /* Dark mode for code block text */
        code {
            color: #ffffff;
        }
    </style>
</head>

<body>
    <h1>Sakila DVD Store: Data Analysis using MySQL</h1>
    <!-- Sakila Database Explanation Section -->
    <div class="explanation">
        <h3>About the Sakila Database</h3>
        <p>
            The <strong>Sakila Database</strong> is a sample database provided by MySQL for learning and demonstrating
            database concepts.
            It is designed to represent a simple DVD rental store, allowing users to practice SQL queries, database
            management, and
            other data analytics operations. The database contains data on films, customers, staff, rentals, and
            payments, which
            makes it an excellent dataset for exploring typical real-world scenarios in a video rental business.
        </p>

        <h3>Tables in the Sakila Database</h3>
        <ul>
            <li><strong>actor</strong>: Information about the actors, including their first and last names.</li>
            <li><strong>address</strong>: Address of Customer and stores.</li>
            <li><strong>category</strong>: 16 different Genre of movies.</li>
            <li><strong>city</strong>: Relation of city belongs to which country.</li>
            <li><strong>country</strong>: Country name and id.</li>
            <li><strong>customer</strong>: Details of the customers who rent films, including their names and addresses.
            </li>
            <li><strong>film</strong>: Stores data on the films, such as title, description, release year, and length.
            </li>
            <li><strong>film_actor</strong>:Information that the actor has worked in which of the movies.</li>
            <li><strong>film_category</strong>: Relation between film and category.</li>
            <li><strong>film_text</strong>: film title with description.</li>
            <li><strong>inventory</strong>: Information about the available copies of films in different store
                locations.</li>
            <li><strong>language</strong>: Language of the film.</li>
            <li><strong>payment</strong>: Details of payments made by customers for their rentals.</li>
            <li><strong>rental</strong>: Records of films rented by customers, including rental date and return date.
            </li>
            <li><strong>staff</strong>: Information about the employees who work in the rental stores.</li>
            <li><strong>store</strong>: Data on the physical store locations from which customers can rent films.</li>
        </ul>

        <h3>Why Use Sakila?</h3>
        <p>
            Sakila is an excellent resource for those who want to improve their SQL skills and learn to work with
            relational databases
            using real-world examples. It is ideal for practicing basic and advanced SQL queries, optimizing database
            structures, and
            performing data analytics tasks such as calculating revenue, customer behavior analysis, and more.
        </p>
    </div>
    <br><br>
    <!-- Beginner level Questions -->
    <div class="Beginner">
        <h2>Beginner</h2>

        <!-- Question 1 -->
        <div class="question">
            <h3>1. Retrieve all records from the actor table.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query1')">Copy Query</button><code id="query1">
    select * from sakila.actor;
            </code></pre>
            </div>
        </div>

        <!-- Question 2 -->
        <div class="question">
            <h3>2. Find all films released in 2006 from the film table.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query2')">Copy Query</button><code id="query2">
    select title, release_year 
    from sakila.film 
    where release_year=2006;
            </code></pre>
            </div>
        </div>

        <!-- Question 3 -->
        <div class="question">
            <h3>3. Get the first and last names of all customers from the customer table.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query3')">Copy Query</button><code id="query3">
    select first_name,last_name 
    from sakila.customer;                
            </code></pre>
            </div>
        </div>

        <!-- Question 4 -->
        <div class="question">
            <h3>4. List all the unique cities from the city table.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query4')">Copy Query</button><code id="query4">
    select distinct(city) 
    from sakila.city;               
            </code></pre>
            </div>
        </div>

        <!-- Question 5 -->
        <div class="question">
            <h3>5. Get the film titles where the rating is 'PG'.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query5')">Copy Query</button><code id="query5">
    select title from sakila.film 
    where rating ='PG';                                  
            </code></pre>
            </div>
        </div>
        <!-- Additional questions and answers go here -->
    </div>


    <br><br><br>

    <!-- Intermediate level Questions -->
    <div class="Intermediate"></div>
    <h2>Intermediate</h2>

    <!-- Question 1 -->
    <div class="question">
        <h3>1. Find all customers who are from the city of 'London'.</h3>
        <div class="answer">
            <pre><button onclick="copyQuery('query6')">Copy Query</button><code id="query6">
    select c.customer_id, concat(c.first_name,' ',c.last_name) as full_name, city
    from sakila.customer as c
    inner join sakila.address as a on a.address_id=c.address_id
    inner join sakila.city on city.city_id=a.city_id
    where city.city='london';                    
            </code></pre>
        </div>
    </div>

    <!-- Question 2 -->
    <div class="question">
        <h3>2. List the top 10 longest films by length.</h3>
        <div class="answer">
            <pre><button onclick="copyQuery('query7')">Copy Query</button><code id="query7">
    select title, length
    from sakila.film
    order by length desc
    limit 10;                    
            </code></pre>
        </div>
    </div>

    <!-- Question 3 -->
    <div class="question">
        <h3>3. Retrieve the count of films in each rating category.</h3>
        <div class="answer">
            <pre><button onclick="copyQuery('query8')">Copy Query</button><code id="query8">
    select rating, count(*) as count
    from sakila.film
    group by rating;
            </code></pre>
        </div>
    </div>

    <!-- Question 4 -->
    <div class="question">
        <h3>4. Find the total amount paid by each customer.</h3>
        <div class="answer">
            <pre><button onclick="copyQuery('query9')">Copy Query</button><code id="query9">
    select c.customer_id, concat(c.first_name,' ',c.last_name) as name, sum(p.amount)
    from sakila.customer as c 
    inner join sakila.payment as p on c.customer_id=p.customer_id
    group by c.customer_id, c.first_name,c.last_name;                                   
            </code></pre>
        </div>
    </div>

    <!-- Question 5 -->
    <div class="question">
        <h3>5. Get a list of all films and their corresponding categories.</h3>
        <div class="answer">
            <pre><button onclick="copyQuery('query10')">Copy Query</button><code id="query10">
    select f.film_id, f.title,c.name as category
    from sakila.film as f 
    inner join sakila.film_category as fc on f.film_id=fc.film_id
    inner join sakila.category as c on c.category_id=fc.category_id;                                                     
            </code></pre>
        </div>
    </div>
    <!-- Additional questions and answers go here -->
    </div>
<br><br><br>
    <!-- Advanced level Questions -->
    <div class="Advanced">
        <h2>Advanced</h2>

        <!-- Question 1 -->
        <div class="question">
            <h3>1.	Get the list of actors who have appeared in more than 20 films.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query11')">Copy Query</button><code id="query11">
    select fa.actor_id,concat(a.first_name,' ',a.last_name) as full_name,count(fa.film_id) 
    from sakila.film_actor as fa
    inner join sakila.actor as a on fa.actor_id=a.actor_id
    group by fa.actor_id 
    having count(fa.film_id)>20
    order by fa.actor_id;                    
        </code></pre>
            </div>
        </div>

        <!-- Question 2 -->
        <div class="question">
            <h3>2.	Retrieve the 5 most rented films along with the number of times they were rented.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query12')">Copy Query</button><code id="query12">
    select f.film_id, f.title, count(i.film_id) as rental_count
    from sakila.inventory as i
    inner join sakila.film as f on f.film_id=i.film_id
    group by i.film_id
    order by count(i.film_id) desc;                    
        </code></pre>
            </div>
        </div>

        <!-- Question 3 -->
        <div class="question">
            <h3>3.	Find the average film length in each film category.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query13')">Copy Query</button><code id="query13">
    select fc.category_id,c.name, avg(f.length)
    from sakila.film as f
    inner join sakila.film_category as fc on f.film_id=fc.film_id
    inner join sakila.category as c on c.category_id=fc.category_id
    group by fc.category_id;                                    
        </code></pre>
            </div>
        </div>

        <!-- Question 4 -->
        <div class="question">
            <h3>4.	Find the customer who has rented the most films.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query14')">Copy Query</button><code id="query14">
    select c.customer_id, concat(c.first_name,' ',c.last_name),count(r.customer_id)
    from sakila.customer as c
    inner join sakila.rental as r on c.customer_id=r.customer_id
    where c.customer_id=(
        select r.customer_id
        from sakila.rental as r
        group by customer_id
        order by count(customer_id) desc limit 1)
    group by c.customer_id;                                 
        </code></pre>
            </div>
        </div>

        <!-- Question 5 -->
        <div class="question">
            <h3>5.	Get the list of films that have not been rented in the last 30 days.</h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query15')">Copy Query</button><code id="query15">
    select f.film_id, f.title
    from sakila.film f
    join sakila.inventory i on f.film_id = i.film_id
    left join sakila.rental r on i.inventory_id = r.inventory_id
    group by f.film_id
    having max(r.rental_date) < curdate() - interval 30 day;                                                                         
        </code></pre>
            </div>
        </div>
        <!-- Additional questions and answers go here -->
    </div>
<br><br><br>


    <h1>Data Analysis on Business Problem</h1>

    <ol>
        <h2 class="business"><li>Customer Segmentation:</li></h2>
        <ol type="I">
            <h3><li>Who are the top 5 customers contributing the most to the revenue?</li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query16')">Copy Query</button><code id="query16">
    select c.customer_id, concat(c.first_name,' ',c.last_name), sum(p.amount)
    from sakila.customer as c
    inner join sakila.payment as p on p.customer_id=c.customer_id
    group by p.customer_id
    order by sum(p.amount) desc
    limit 5;                                                                                             
        </code></pre>
            </div>
            <h3><li>Identify customers renting frequently </li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query17')">Copy Query</button><code id="query17">
    SELECT c.customer_id, concat(c.first_name,' ',c.last_name) as full_name, count(r.customer_id) as frequency
    FROM sakila.customer as c
    inner join sakila.rental as r on c.customer_id=r.customer_id
    group by customer_id
    order by count(r.customer_id) desc;                                                                                            
        </code></pre>
            </div>
            <h3><li>those inactive for more than 6 months.</li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query18')">Copy Query</button><code id="query18">
    select c.customer_id, concat(c.first_name,' ',c.last_name) as full_name, c.active, c.last_update
    from sakila.customer as c
    where last_update < current_date()-interval 6 month and active=0;
                                                                                          
        </code></pre>
            </div>
        </ol>

        <br><br>
        <h2 class="business"><li>Film Inventory:</li></h2>
        <ol type="I">
            <h3><li>Which films are generating the most rentals in the last 6 months?</li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query19')">Copy Query</button><code id="query19">
    select f.film_id,f.title, count(f.film_id)
    from sakila.film as f
    inner join sakila.inventory as i on i.film_id=f.film_id
    inner join sakila.rental as r on r.inventory_id=i.inventory_id
    where r.rental_date < current_date()-interval-6 month
    group by f.film_id
    order by count(f.film_id) desc;                                                                     
        </code></pre>
            </div>
            <h3><li>Identify films that have not been rented in the past 3 months to evaluate underperforming inventory.</li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query20')">Copy Query</button><code id="query20">
    select f.film_id,f.title, max(r.rental_date) as date
    from sakila.film f
    join sakila.inventory i on f.film_id = i.film_id
    left join sakila.rental r on i.inventory_id = r.inventory_id
    group by f.film_id
    having max(r.rental_date) < current_date() - interval 3 month;
        </code></pre>
            </div>
        </ol>

        <br><br>
        <h2 class="business"><li>Revenue Trends:</li></h2>
        <ol type="I">
            <h3><li>What are the monthly revenue trends over the past year?</li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query21')">Copy Query</button><code id="query21">
    select date_format(p.payment_date, '%Y-%m') as month, sum(p.amount) as total_revenue
    from sakila.payment p
    where p.payment_date < current_date()
    group by month
    order by date_format(p.payment_date,'%Y-%m');                    
        </code></pre>
            </div>
            <h3><li>How much revenue is being generated per store location?li></h3>
            <div class="answer">
                <pre><button onclick="copyQuery('query22')">Copy Query</button><code id="query22">
    select s.store_id, sum(p.amount)
    from sakila.store as s
    inner join sakila.payment as p on p.staff_id=s.manager_staff_id
    group by store_id;                    
        </code></pre>
            </div>
        </ol>

        <br><br>
        <h2 class="business"><li>Store Performance:</li></h2>
        <ol type="I">
            <h3><li>Which store has the highest rental volume?</li></h3>
            <div class="answer"></div>
                <pre><button onclick="copyQuery('query23')">Copy Query</button><code id="query23">
    select s.store_id, count(r.rental_id) as volume
    from sakila.rental as r
    inner join sakila.store as s on r.staff_id=s.manager_staff_id
    group by store_id
    order by volume desc
    limit 1;                                       
        </code></pre>
            </div>
            <h3><li>Which store has the highest revenue?</li></h3>
            <div class="answer"></div>
                <pre><button onclick="copyQuery('query24')">Copy Query</button><code id="query24">
    select s.store_id, sum(p.amount) as store_revenue
    from sakila.store as s
    inner join sakila.payment as p on p.staff_id=s.manager_staff_id
    group by store_id
    order by store_revenue desc
    limit 1;                                        
        </code></pre>
            </div>
        </ol>
    </ol>



    <script>
        // Function to copy SQL queries to clipboard
        function copyQuery(queryId) {
            const queryElement = document.getElementById(queryId);
            const textArea = document.createElement('textarea');
            textArea.value = queryElement.textContent.trim(); // Trim any excess spaces
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            // alert('Query copied to clipboard!');
        }
    </script>

</body>

</html>